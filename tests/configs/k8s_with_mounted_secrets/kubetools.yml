name: generic-app-with-secrets


containerContexts:
  generic-context:
    image: generic-image
    command: [generic-command]
    ports:
      - 80

upgrades:
  - name: Upgrade the database
    containerContext: generic-context
    command: [generic-command, generic-arg]
    serviceAccountName: generic-account
    secrets:
      secret-volume:
        mountPath: /mnt/upgrades-secrets-store
        secretProviderClass: secrets
    resources:
      requests:
        memory: "1Gi"

dependencies:
  generic-dependency-with-secrets:
    serviceAccountName: web-api
    secrets:
      secret-volume:
        mountPath: /mnt/secrets-store
        secretProviderClass: secrets
    containers:
      generic-dependency:
        containerContext: generic-context


deployments:
  generic-deployment-with-secrets:
    serviceAccountName: web-api
    secrets:
      secret-volume:
        mountPath: /mnt/secrets-store
        secretProviderClass: secrets
    containers:
      generic-deployment-workers:
        containerContext: generic-context


cronjobs:
  generic-cronjob:
    schedule: "*/1 * * * *"
    concurrency_policy: "Allow"
    serviceAccountName: generic-account
    secrets:
      secret-volume:
        mountPath: /mnt/cronjobs-secrets-store
        secretProviderClass: secrets
    containers:
      generic-container:
        containerContext: generic-context
